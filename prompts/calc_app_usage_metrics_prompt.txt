# Parameters:
prompt_name = "calc_app_usage_metrics.txt"
version = "1.1"
target_function_name: calc_app_usage_metrics

Write a production-grade Python function named {{target_function_name}} accepts:
1. A pandas DataFrame named `df`.
 - df should not be empty
 - df should contain at least these columns: 'User Principal Name',

- error handling.   Any issues should result in raised exceptions with suitable error strings

The function should:
- have a variable named col_prefix with value 'Last activity date of '
- have a variable named col_postfix with value ' (UTC)'
- copy df into a dataframe named df_apps
- remove every column of df_apps not named 'User Principal Name' or having a name that begins with col_prefix and ends with col_postfix
- update df_apps to store the maximum value or each column for each 'User Principal Name'
- for each column in df_apps not named 'User Principal Name':
    - replace every value that is not blank with an integer of value 1
    - replace every value that is equal to 1 with integer 0
    - rename the column by removing col_prefix from the beginning of the column name and col_postfix from the end of the column name

- return df_apps


Generate comprehensive pytests for all negative and positive cases suitable for a file named test_{{target_function_name}}.py


#### COMMON instructions BEGIN

The function must follow current Python best practices, including:
- Type hints for input and output
- A docstring formatted with Google-style conventions
- Input validation: raise `TypeError` if inputs do not match type hints
- Clear and descriptive variable names
- PEP 8 formatting and clean structure
- Ready for inclusion in a larger codebase or module
- Ensure that all required parameters are present and are of the correct python type
- Generated code should pass Pylint with a score of 9.0+ and avoid global variables
- At the top of every file generated, include a comment block with:
  - GENERATED FILE - DO NOT EDIT DIRECTLY.
  - Prompt: [prompt_name]  Version: [version]
  - Generated by:[LLM name and version].
  - Timestamp:[current time in ISO 8601 format and UTC timezone]
#### COMMON instructions END






