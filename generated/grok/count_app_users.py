# GENERATED FILE - DO NOT EDIT DIRECTLY.
# Prompt: count_app_users.txt  Version: 1.1
# Generated by: Grok, created by xAI
# Timestamp: 2025-09-02T00:08:00Z

from typing import List, Dict
import pandas as pd
from pandas import DataFrame

def count_app_users(df: DataFrame) -> List[Dict[str, any]]:
    """Calculate user counts and percentages for each application column in a DataFrame.

    Args:
        df (DataFrame): Input DataFrame containing application usage data.

    Returns:
        List[Dict[str, any]]: List of dictionaries containing app name, user count, and percentage of users.

    Raises:
        TypeError: If df is not a pandas DataFrame.
        ValueError: If df is empty or has no columns.
    """
    # Input validation
    if not isinstance(df, DataFrame):
        raise TypeError("Input 'df' must be a pandas DataFrame")
    if df.empty:
        raise ValueError("Input DataFrame cannot be empty")
    if df.columns.empty:
        raise ValueError("Input DataFrame must have at least one column")

    app_usage: List[Dict[str, any]] = []

    # Calculate metrics for each column
    total_rows = len(df)
    for column in df.columns:
        # Calculate sum and percentage
        nusers = df[column].sum()
        percusers = (nusers / total_rows) if total_rows > 0 else 0.0

        # Create dictionary for this column
        app_dict = {
            'app': column,
            'nusers': int(nusers),
            'percusers': float(percusers)
        }
        app_usage.append(app_dict)

    return app_usage
