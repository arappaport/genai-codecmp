# GENERATED FILE - DO NOT EDIT DIRECTLY.
# Prompt: count_app_users.txt  Version: 1.1
# Generated by: Microsoft Copilot (GPT-4)
# Timestamp: 2025-09-01T23:47:00Z

from typing import List, Dict
import pandas as pd


def count_app_users(df: pd.DataFrame) -> List[Dict[str, object]]:
    """Count the number and percentage of users per app column.

    Args:
        df (pd.DataFrame): Input DataFrame with binary usage indicators per app.

    Returns:
        List[Dict[str, object]]: List of dictionaries with app usage metrics.

    Raises:
        TypeError: If input is not a pandas DataFrame.
        ValueError: If DataFrame is empty or has no columns.
    """
    if not isinstance(df, pd.DataFrame):
        raise TypeError("Input must be a pandas DataFrame.")

    if df.empty or df.shape[1] == 0:
        raise ValueError("Input DataFrame must not be empty and must contain at least one column.")

    app_usage: List[Dict[str, object]] = []

    for column in df.columns:
        try:
            nusers = df[column].sum()
            percusers = float(nusers) / len(df)
        except Exception as e:
            raise RuntimeError(f"Failed to compute usage for column '{column}': {e}") from e

        app_usage.append({
            'app': column,
            'nusers': int(nusers),
            'percusers': round(percusers, 4)
        })

    return app_usage